
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../single_field/">
      
      
        <link rel="next" href="../../transitionFinder/transitionFinder/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>Tests of SF functions - CosmoTransitions (modernized)</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="amber">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#tests-single-field-instanton" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="CosmoTransitions (modernized)" class="md-header__button md-logo" aria-label="CosmoTransitions (modernized)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CosmoTransitions (modernized)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Tests of SF functions
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="amber"  aria-label="Switch to light"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="amber"  aria-label="Switch to dark"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="CosmoTransitions (modernized)" class="md-nav__button md-logo" aria-label="CosmoTransitions (modernized)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    CosmoTransitions (modernized)
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../roadmap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Roadmap & Flowchart
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Architecture
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Examples (Core modules)
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Examples (Core modules)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/example_tunneling1D/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tunneling 1D full example
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Modules
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Modules
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Helper Functions
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            Helper Functions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../helper_functions/Miscellaneous_functions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Miscellaneous Functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../helper_functions/Numerical_integration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Numerical Integration Functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../helper_functions/Numerical_derivatives/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Numerical Derivatives Functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../helper_functions/interpolation_functions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Interpolation Functions
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Finite Temperature (One loop corrections)
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            Finite Temperature (One loop corrections)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../finiteT/Exact_Thermal_Integrals/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Exact Thermal Integrals
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../finiteT/Spline_Thermal_Integrals/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Spline Thermal Integrals
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../finiteT/Approx_Thermal_Integrals/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Approx Thermal Integrals
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../finiteT/Short_Hand_Jb%26Jf/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Short Hand for All Thermal Integrals
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3" checked>
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Tunneling (1D)
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            Tunneling (1D)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../single_field/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Single Field functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Tests of SF functions
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Tests of SF functions
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#lot-sf-1-potential-interface-validations" class="md-nav__link">
    <span class="md-ellipsis">
      Lot SF-1 — Potential Interface &amp; Validations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lot SF-1 — Potential Interface &amp; Validations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-1-metastability-validation-exception-path" class="md-nav__link">
    <span class="md-ellipsis">
      Example 1 — Metastability validation (exception path)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-2-accuracy-of-derivative-helpers-o4-vs-o2-near-minimum-blend-tests-3-4" class="md-nav__link">
    <span class="md-ellipsis">
      Example 2 — Accuracy of derivative helpers (o4 vs o2) &amp; near-minimum blend (Tests 3 + 4)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-3-visual-check-vphi-vphi-vphi-test-5" class="md-nav__link">
    <span class="md-ellipsis">
      Example 3 — Visual check: \((V(\phi)), (V'(\phi)), (V''(\phi))\) (Test 5)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lot-sf-2-barrier-scales" class="md-nav__link">
    <span class="md-ellipsis">
      Lot SF-2 — Barrier &amp; scales
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lot SF-2 — Barrier &amp; scales">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#test-a-thin-wall-barrier-markers-scales" class="md-nav__link">
    <span class="md-ellipsis">
      Test A — Thin-wall: barrier markers &amp; scales
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-b-thick-wall-barrier-markers-scales" class="md-nav__link">
    <span class="md-ellipsis">
      Test B — Thick-wall: barrier markers &amp; scales
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lot-3-quadratic-local-solution-initial-conditions" class="md-nav__link">
    <span class="md-ellipsis">
      Lot 3 — Quadratic local solution &amp; initial conditions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lot 3 — Quadratic local solution &amp; initial conditions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#test-1-local-quadratic-solution-near-the-true-minimum-stable-curvature" class="md-nav__link">
    <span class="md-ellipsis">
      Test 1 — Local quadratic solution near the true minimum (stable curvature)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-2-local-solution-near-the-barrier-top-unstable-curvature" class="md-nav__link">
    <span class="md-ellipsis">
      Test 2 — Local solution near the barrier top (unstable curvature)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-4-initialconditions-pick-r_0phir_0phir_0-and-visualize-the-short-path" class="md-nav__link">
    <span class="md-ellipsis">
      Test 4 — initialConditions: pick \(((r_0,\phi(r_0),\phi'(r_0)))\) and visualize the short path
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-5-initialconditions-error-path-unreachable-cutoff" class="md-nav__link">
    <span class="md-ellipsis">
      Test 5 — initialConditions error path (unreachable cutoff)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lot-sf-4-ode-core-eom-event-detection-sampler" class="md-nav__link">
    <span class="md-ellipsis">
      Lot SF-4 — ODE core (EOM, event detection, sampler)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lot SF-4 — ODE core (EOM, event detection, sampler)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#test-b-thin-wall-event-detection-two-undershoots" class="md-nav__link">
    <span class="md-ellipsis">
      Test B — Thin-wall: event detection (two undershoots)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-c-thick-wall-one-undershoot-one-overshoot" class="md-nav__link">
    <span class="md-ellipsis">
      Test C — Thick-wall: one undershoot, one overshoot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-d-sampling-with-integrateandsaveprofile-on-a-user-grid" class="md-nav__link">
    <span class="md-ellipsis">
      Test D — Sampling with integrateAndSaveProfile on a user grid
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-f-explicit-initial-conditions-thin-wall" class="md-nav__link">
    <span class="md-ellipsis">
      Test F — Explicit initial conditions (thin-wall)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lot-sf-5-profile-search-findprofile" class="md-nav__link">
    <span class="md-ellipsis">
      Lot SF-5 — Profile search (findProfile)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lot SF-5 — Profile search (findProfile)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#test-1-legacy-demo-thin-thick-walls-default-settings" class="md-nav__link">
    <span class="md-ellipsis">
      Test 1 — Legacy demo: thin &amp; thick walls (default settings)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-2-sensitivity-to-thincutoff-and-interior-fill-thin-wall" class="md-nav__link">
    <span class="md-ellipsis">
      Test 2 — Sensitivity to thinCutoff and interior fill (thin wall)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lot-sf-6-action-post-processing" class="md-nav__link">
    <span class="md-ellipsis">
      Lot SF-6 — Action &amp; post-processing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lot SF-6 — Action &amp; post-processing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#test-a-action-density-breakdown" class="md-nav__link">
    <span class="md-ellipsis">
      Test A — Action &amp; density breakdown
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-b-uniform-grid-resampling-evenlyspacedphi" class="md-nav__link">
    <span class="md-ellipsis">
      Test B — Uniform φ-grid resampling (evenlySpacedPhi)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-c-wall-diagnostics-location-thickness" class="md-nav__link">
    <span class="md-ellipsis">
      Test C — Wall diagnostics (location &amp; thickness)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-d-beta_rm-eff-proxies-rscale-vs-curvature-vs-wall" class="md-nav__link">
    <span class="md-ellipsis">
      Test D — \((\beta_{\rm eff})\) proxies: rscale vs curvature vs wall
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_4" >
        
          
          <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Transition Finder
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_4">
            <span class="md-nav__icon md-icon"></span>
            Transition Finder
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transitionFinder/transitionFinder/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Transition Functions
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_5" >
        
          
          <label class="md-nav__link" for="__nav_5_5" id="__nav_5_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Generic Potential
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_5">
            <span class="md-nav__icon md-icon"></span>
            Generic Potential
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../generic_potential/generic_potential/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Potential Functions
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#lot-sf-1-potential-interface-validations" class="md-nav__link">
    <span class="md-ellipsis">
      Lot SF-1 — Potential Interface &amp; Validations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lot SF-1 — Potential Interface &amp; Validations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-1-metastability-validation-exception-path" class="md-nav__link">
    <span class="md-ellipsis">
      Example 1 — Metastability validation (exception path)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-2-accuracy-of-derivative-helpers-o4-vs-o2-near-minimum-blend-tests-3-4" class="md-nav__link">
    <span class="md-ellipsis">
      Example 2 — Accuracy of derivative helpers (o4 vs o2) &amp; near-minimum blend (Tests 3 + 4)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-3-visual-check-vphi-vphi-vphi-test-5" class="md-nav__link">
    <span class="md-ellipsis">
      Example 3 — Visual check: \((V(\phi)), (V'(\phi)), (V''(\phi))\) (Test 5)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lot-sf-2-barrier-scales" class="md-nav__link">
    <span class="md-ellipsis">
      Lot SF-2 — Barrier &amp; scales
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lot SF-2 — Barrier &amp; scales">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#test-a-thin-wall-barrier-markers-scales" class="md-nav__link">
    <span class="md-ellipsis">
      Test A — Thin-wall: barrier markers &amp; scales
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-b-thick-wall-barrier-markers-scales" class="md-nav__link">
    <span class="md-ellipsis">
      Test B — Thick-wall: barrier markers &amp; scales
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lot-3-quadratic-local-solution-initial-conditions" class="md-nav__link">
    <span class="md-ellipsis">
      Lot 3 — Quadratic local solution &amp; initial conditions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lot 3 — Quadratic local solution &amp; initial conditions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#test-1-local-quadratic-solution-near-the-true-minimum-stable-curvature" class="md-nav__link">
    <span class="md-ellipsis">
      Test 1 — Local quadratic solution near the true minimum (stable curvature)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-2-local-solution-near-the-barrier-top-unstable-curvature" class="md-nav__link">
    <span class="md-ellipsis">
      Test 2 — Local solution near the barrier top (unstable curvature)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-4-initialconditions-pick-r_0phir_0phir_0-and-visualize-the-short-path" class="md-nav__link">
    <span class="md-ellipsis">
      Test 4 — initialConditions: pick \(((r_0,\phi(r_0),\phi'(r_0)))\) and visualize the short path
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-5-initialconditions-error-path-unreachable-cutoff" class="md-nav__link">
    <span class="md-ellipsis">
      Test 5 — initialConditions error path (unreachable cutoff)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lot-sf-4-ode-core-eom-event-detection-sampler" class="md-nav__link">
    <span class="md-ellipsis">
      Lot SF-4 — ODE core (EOM, event detection, sampler)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lot SF-4 — ODE core (EOM, event detection, sampler)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#test-b-thin-wall-event-detection-two-undershoots" class="md-nav__link">
    <span class="md-ellipsis">
      Test B — Thin-wall: event detection (two undershoots)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-c-thick-wall-one-undershoot-one-overshoot" class="md-nav__link">
    <span class="md-ellipsis">
      Test C — Thick-wall: one undershoot, one overshoot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-d-sampling-with-integrateandsaveprofile-on-a-user-grid" class="md-nav__link">
    <span class="md-ellipsis">
      Test D — Sampling with integrateAndSaveProfile on a user grid
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-f-explicit-initial-conditions-thin-wall" class="md-nav__link">
    <span class="md-ellipsis">
      Test F — Explicit initial conditions (thin-wall)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lot-sf-5-profile-search-findprofile" class="md-nav__link">
    <span class="md-ellipsis">
      Lot SF-5 — Profile search (findProfile)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lot SF-5 — Profile search (findProfile)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#test-1-legacy-demo-thin-thick-walls-default-settings" class="md-nav__link">
    <span class="md-ellipsis">
      Test 1 — Legacy demo: thin &amp; thick walls (default settings)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-2-sensitivity-to-thincutoff-and-interior-fill-thin-wall" class="md-nav__link">
    <span class="md-ellipsis">
      Test 2 — Sensitivity to thinCutoff and interior fill (thin wall)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lot-sf-6-action-post-processing" class="md-nav__link">
    <span class="md-ellipsis">
      Lot SF-6 — Action &amp; post-processing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lot SF-6 — Action &amp; post-processing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#test-a-action-density-breakdown" class="md-nav__link">
    <span class="md-ellipsis">
      Test A — Action &amp; density breakdown
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-b-uniform-grid-resampling-evenlyspacedphi" class="md-nav__link">
    <span class="md-ellipsis">
      Test B — Uniform φ-grid resampling (evenlySpacedPhi)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-c-wall-diagnostics-location-thickness" class="md-nav__link">
    <span class="md-ellipsis">
      Test C — Wall diagnostics (location &amp; thickness)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-d-beta_rm-eff-proxies-rscale-vs-curvature-vs-wall" class="md-nav__link">
    <span class="md-ellipsis">
      Test D — \((\beta_{\rm eff})\) proxies: rscale vs curvature vs wall
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="tests-single-field-instanton">Tests — Single Field Instanton<a class="headerlink" href="#tests-single-field-instanton" title="Permanent link">&para;</a></h1>
<p>This page collects <strong>hands-on examples</strong> for the Single Field Instanton module, organized by lot. 
Each example states the <strong>physical meaning</strong>, the <strong>expected outcome</strong>, a slot for the <strong>console output/code</strong> and (when applicable) an <strong>image</strong> slot.</p>
<blockquote>
<p>These examples correspond to the class SingleFieldInstaton only.</p>
</blockquote>
<hr />
<h2 id="lot-sf-1-potential-interface-validations">Lot SF-1 — Potential Interface &amp; Validations<a class="headerlink" href="#lot-sf-1-potential-interface-validations" title="Permanent link">&para;</a></h2>
<p>See the full, executable script for this lot here: <a href="/tests/tunneling1D/single_field/Lot_SF1.py"><code>tests/single_field/Lot_SF_1.py</code></a>.
for all example the potential chosen was:</p>
<div class="arithmatex">\[\text{THIN}: \frac{1}{4}\phi ^4 - 0.49\phi ^3 + 0.235 \phi ^2 \]</div>
<div class="arithmatex">\[\text{THICK}:  \frac{1}{4}\phi ^4 - \frac{2}{5}\phi^3 + \frac{1}{10}\phi^2 \]</div>
<p><strong>How to run just this case</strong></p>
<div class="highlight"><pre><span></span><code>python<span class="w"> </span>-m<span class="w"> </span>tests.tunneling1D.single_field.Lot_SF1<span class="w"> </span>
</code></pre></div>
<h3 id="example-1-metastability-validation-exception-path">Example 1 — Metastability validation (exception path)<a class="headerlink" href="#example-1-metastability-validation-exception-path" title="Permanent link">&para;</a></h3>
<p><strong>What it shows (physics):</strong>
A tunneling solution exists only if the <strong>false (metastable) vacuum is higher</strong> in energy than the <strong>true (absolute) vacuum</strong>: <span class="arithmatex">\((V(\phi_{\text{meta}}) &gt; V(\phi_{\text{abs}}))\)</span>. 
Swapping them violates metastability and must raise a clear error.</p>
<p><strong>Expected result:</strong>
Constructing <code>SingleFieldInstanton</code> with <code>V(phi_metaMin) ≤ V(phi_absMin)</code> raises a <code>PotentialError</code> explaining that the configuration is “stable, not metastable.”</p>
<p><strong>Console output:</strong></p>
<div class="highlight"><pre><span></span><code>=== Test 1: Metastability validation ===
OK: PotentialError raised as expected -&gt; (&#39;V(phi_metaMin) &lt;= V(phi_absMin); tunneling cannot occur.&#39;, &#39;stable, not metastable&#39;)
</code></pre></div>
<hr />
<h3 id="example-2-accuracy-of-derivative-helpers-o4-vs-o2-near-minimum-blend-tests-3-4">Example 2 — Accuracy of derivative helpers (o4 vs o2) &amp; near-minimum blend (Tests 3 + 4)<a class="headerlink" href="#example-2-accuracy-of-derivative-helpers-o4-vs-o2-near-minimum-blend-tests-3-4" title="Permanent link">&para;</a></h3>
<p><strong>What it shows (physics):</strong></p>
<ul>
<li>For smooth potentials, <strong>4th-order FD</strong> (our default) is more accurate than 2nd-order for both (V') and (V'').</li>
<li>Very close to the absolute minimum, the helper <strong><code>dV_from_absMin</code></strong> smoothly blends to the local linear behavior <span class="arithmatex">\((V'(\phi)\approx V''(\phi),\Delta\phi)\)</span>
, improving numerical stability where finite differences can be noisy.</li>
</ul>
<p><strong>Expected result:</strong></p>
<ul>
<li>Reported max errors for o(4) are <strong>lower</strong> than for o(2) when compared to analytic (V') and (V'') (both <strong>thin</strong> and <strong>thick</strong> quartic examples).</li>
<li>The lines <code>delta=... -&gt; dV_from_absMin=..., ref≈d2V*delta=..., rel.err=...</code> show <strong>tiny relative errors</strong> (≪ 1% for the tiny offsets used).</li>
</ul>
<p><strong>Console output:</strong></p>
<div class="highlight"><pre><span></span><code>=== Test 3: Built-in FD vs analytic derivatives ===
[THIN] max|dV_fd4 - dV_true|  = 1.253e-13
[THIN] max|d2V_fd4 - d2V_true|= 3.888e-10
[THIN] max|dV_fd2 - dV_true|  = 7.100e-07
[THIN] max|d2V_fd2 - d2V_true|= 5.002e-07
[THIN] barrier check: V(phi_bar) - V(phi_metaMin) = +2.602e-12

[THICK] max|dV_fd4 - dV_true|  = 1.127e-13
[THICK] max|d2V_fd4 - d2V_true|= 3.779e-10
[THICK] max|dV_fd2 - dV_true|  = 8.000e-07
[THICK] max|d2V_fd2 - d2V_true|= 5.002e-07
[THICK] barrier check: V(phi_bar) - V(phi_metaMin) = +3.056e-11

=== Test 4: dV_from_absMin near φ_absMin ===
delta=1.0e-06 -&gt; dV_from_absMin=5.300e-07, ref≈d2V*delta=5.300e-07, rel.err=4.538e-10
delta=5.0e-06 -&gt; dV_from_absMin=2.650e-06, ref≈d2V*delta=2.650e-06, rel.err=5.739e-11
delta=1.0e-05 -&gt; dV_from_absMin=5.300e-06, ref≈d2V*delta=5.300e-06, rel.err=3.055e-09
delta=5.0e-05 -&gt; dV_from_absMin=2.651e-05, ref≈d2V*delta=2.651e-05, rel.err=3.604e-07
</code></pre></div>
<hr />
<h3 id="example-3-visual-check-vphi-vphi-vphi-test-5">Example 3 — Visual check: <span class="arithmatex">\((V(\phi)), (V'(\phi)), (V''(\phi))\)</span> (Test 5)<a class="headerlink" href="#example-3-visual-check-vphi-vphi-vphi-test-5" title="Permanent link">&para;</a></h3>
<p><strong>What it shows (physics):</strong></p>
<ul>
<li><strong>Potential shapes</strong> for thin vs thick cases.</li>
<li>Agreement between <strong>analytic</strong> and <strong>built-in</strong> derivative operators for (V') and (V'').</li>
<li>This is a pre-instanton sanity check that the potential interface + derivative helpers behave as expected.</li>
</ul>
<p><strong>Expected result:</strong></p>
<ul>
<li>Curves for analytic vs built-in (V') and (V'') <strong>visually overlap</strong>.</li>
<li>Residuals printed by the script are <strong>small</strong> (implementation- and BLAS-dependent, typically in the (10^{-8})–(10^{-6}) range on these quartics).</li>
</ul>
<p><strong>Image slots:</strong></p>
<p><em>Thin-wall — Potential</em>
<img alt="THIN: Potential" src="../assets/SF1_1.png" /></p>
<p><em>Thin-wall — First derivative</em>
<img alt="THIN: First derivative" src="../assets/SF1_2.png" /></p>
<p><em>Thin-wall — Second derivative</em>
<img alt="THIN: Second derivative" src="../assets/SF1_3.png" /></p>
<p><em>Thick-wall — Potential</em>
<img alt="THICK: Potential" src="../assets/SF1_4.png" /></p>
<p><em>Thick-wall — First derivative</em>
<img alt="THICK: First derivative" src="../assets/SF1_5.png" /></p>
<p><em>Thick-wall — Second derivative</em>
<img alt="THICK: Second derivative" src="../assets/SF1_6.png" /></p>
<p><strong>Console output:</strong></p>
<div class="highlight"><pre><span></span><code>=== Test 5: Plots (potential and derivatives) ===
[THIN] residuals: max|V&#39;_fd - V&#39;_ref|=1.253e-13, max|V&#39;&#39;_fd - V&#39;&#39;_ref|=3.888e-10
[THICK] residuals: max|V&#39;_fd - V&#39;_ref|=1.127e-13, max|V&#39;&#39;_fd - V&#39;&#39;_ref|=3.779e-10

---------- END OF TESTS: Lot SF-1 ----------
</code></pre></div>
<hr />
<h2 id="lot-sf-2-barrier-scales">Lot SF-2 — Barrier &amp; scales<a class="headerlink" href="#lot-sf-2-barrier-scales" title="Permanent link">&para;</a></h2>
<p><strong>Goal.</strong> Visualize the <strong>potential barrier geometry</strong> and report the <strong>characteristic length scale(s)</strong> used by the solver:</p>
<ul>
<li>
<p>Vertical markers for:</p>
</li>
<li>
<p><span class="arithmatex">\(( \phi_{\rm top} )\)</span>: location of the barrier maximum between <span class="arithmatex">\(( \phi_{\rm meta} )\)</span> and <span class="arithmatex">\(( \phi_{\rm bar} )\)</span>;</p>
</li>
<li><span class="arithmatex">\(( \phi_{\rm bar} )\)</span>: “edge” on the downhill side where <span class="arithmatex">\(( V(\phi_{\rm bar}) = V(\phi_{\rm meta}) )\)</span>.</li>
<li>Horizontal line at <span class="arithmatex">\(( V(\phi_{\rm meta}) )\)</span>.</li>
<li>
<p>Printed diagnostics:</p>
</li>
<li>
<p><code>phi_top</code>, <code>phi_bar</code>, <span class="arithmatex">\(( \Delta V_{\rm top} \equiv V(\phi_{\rm top}) - V(\phi_{\rm meta}) )\)</span>;</p>
</li>
<li><code>rscale_cubic</code> (robust/legacy) and, when defined, <code>rscale_curv</code> from <span class="arithmatex">\((V''(\phi_{\rm top}))\)</span>.</li>
</ul>
<p>Physics intuition:</p>
<ul>
<li><strong>Thin wall</strong> (nearly degenerate minima) → <strong>sharper</strong> barrier (more negative (V'') at the top) → <strong>smaller</strong> length scale (wall is thinner).</li>
<li><strong>Thick wall</strong> (more separated minima) → <strong>broader</strong> barrier → <strong>larger</strong> length scale.</li>
</ul>
<p>See the full, executable script for this lot here: <a href="/tests/tunneling1D/single_field/Lot_SF2.py"><code>tests/single_field/Lot_SF2.py</code></a>.
for all example the potential chosen was:</p>
<div class="arithmatex">\[\text{THIN}: \frac{1}{4}\phi ^4 - 0.49\phi ^3 + 0.235 \phi ^2 \]</div>
<div class="arithmatex">\[\text{THICK}:  \frac{1}{4}\phi ^4 - \frac{2}{5}\phi^3 + \frac{1}{10}\phi^2 \]</div>
<p><strong>Script:</strong> <code>tests/tunneling1D/single_field/Lot_SF2.py</code></p>
<p><strong>How to run just this case (Run both examples at once)</strong></p>
<div class="highlight"><pre><span></span><code>python<span class="w"> </span>-m<span class="w"> </span>tests.tunneling1D.single_field.Lot_SF2<span class="w">  </span><span class="c1"># it includes thin- and thick-wall cases</span>
</code></pre></div>
<hr />
<h3 id="test-a-thin-wall-barrier-markers-scales">Test A — Thin-wall: barrier markers &amp; scales<a class="headerlink" href="#test-a-thin-wall-barrier-markers-scales" title="Permanent link">&para;</a></h3>
<p><strong>What this shows</strong></p>
<ul>
<li><span class="arithmatex">\((V(\phi))\)</span> with the barrier <strong>top</strong> and <strong>edge</strong> identified.</li>
<li>Console readout with the <strong>barrier height</strong> and the two characteristic scales.</li>
</ul>
<p><strong>Expected outcome (physics)</strong></p>
<ul>
<li><span class="arithmatex">\((\phi_{\rm top})\)</span> sits between <span class="arithmatex">\((\phi_{\rm meta}=0)\)</span> and <span class="arithmatex">\((\phi_{\rm abs}=1)\)</span>.</li>
<li><span class="arithmatex">\((V(\phi_{\rm top}) &gt; V(\phi_{\rm meta}))\)</span> so <span class="arithmatex">\(( \Delta V_{\rm top} &gt; 0 )\)</span>.</li>
<li><code>rscale_cubic</code> is finite and typically <strong>smaller</strong> than in the thick-wall case (thinner wall).</li>
<li><code>rscale_curv</code> is reported <strong>finite</strong> if <span class="arithmatex">\((V''(\phi_{\rm top})&lt;0)\)</span>; otherwise shown as ∞ (flat top).</li>
</ul>
<p><strong>Example console output</strong></p>
<div class="highlight"><pre><span></span><code>========================================================================
CASE: Thin-wall demo
========================================================================
Barrier diagnostics:
  phi_metaMin = 0,  V(phi_metaMin) = 0
  phi_top     = 0.46999999834,  ΔV_top ≡ V(top)-V(meta) = 0.0132374325
  phi_bar     = 0.837171431377  (V equals V(phi_metaMin) on downhill side)
Scale diagnostics:
  rscale_cubic (legacy/robust) = 1.66770930502
  rscale_curv  (from V&#39;&#39; at top)= 2.00360975005  with  V&#39;&#39;(top) = -0.249099999801
</code></pre></div>
<p><strong>Figure</strong>
<em>“Thin-wall demo: Potential with barrier markers.”</em>
<img alt="THIN: Potential with markers" src="../assets/SF2_1.png" /></p>
<hr />
<h3 id="test-b-thick-wall-barrier-markers-scales">Test B — Thick-wall: barrier markers &amp; scales<a class="headerlink" href="#test-b-thick-wall-barrier-markers-scales" title="Permanent link">&para;</a></h3>
<p><strong>What this shows</strong></p>
<ul>
<li>Same plot/diagnostics as Test A, now for a <strong>broader</strong> barrier.</li>
</ul>
<p><strong>Expected outcome (physics)</strong></p>
<ul>
<li><span class="arithmatex">\((\phi_{\rm top})\)</span> again lies between <span class="arithmatex">\((\phi_{\rm meta})\)</span> and <span class="arithmatex">\((\phi_{\rm abs})\)</span>.</li>
<li>Barrier height and curvature differ from the thin-wall case; you should observe a <strong>larger</strong> <code>rscale_cubic</code> (thicker wall).</li>
<li><code>rscale_curv</code> is finite if the barrier top is genuinely curved; otherwise ∞ for a flat-ish top.</li>
</ul>
<p><strong>Example console output (you will paste your run here)</strong></p>
<div class="highlight"><pre><span></span><code>========================================================================
CASE: Thick-wall demo
========================================================================
Barrier diagnostics:
  phi_metaMin = 0,  V(phi_metaMin) = 0
  phi_top     = 0.200000001967,  ΔV_top ≡ V(top)-V(meta) = 0.0012
  phi_bar     = 0.310102050146  (V equals V(phi_metaMin) on downhill side)
Scale diagnostics:
  rscale_cubic (legacy/robust) = 2.35702262713
  rscale_curv  (from V&#39;&#39; at top)= 2.49999998156  with  V&#39;&#39;(top) = -0.16000000236
</code></pre></div>
<p><strong>Figure</strong>
<em>“Thick-wall demo: Potential with barrier markers.”</em>
<img alt="THICK: Potential with markers" src="../assets/SF2_2.png" /></p>
<hr />
<h2 id="lot-3-quadratic-local-solution-initial-conditions">Lot 3 — Quadratic local solution &amp; initial conditions<a class="headerlink" href="#lot-3-quadratic-local-solution-initial-conditions" title="Permanent link">&para;</a></h2>
<p>See the full, executable script for this lot here: <a href="/tests/tunneling1D/single_field/Lot_SF3.py"><code>tests/single_field/Lot_SF3.py</code></a>.
for all example the potential chosen was:</p>
<div class="arithmatex">\[\text{THIN}: \frac{1}{4}\phi ^4 - 0.49\phi ^3 + 0.235 \phi ^2 \]</div>
<div class="arithmatex">\[\text{THICK}:  \frac{1}{4}\phi ^4 - \frac{2}{5}\phi^3 + \frac{1}{10}\phi^2 \]</div>
<p>This lot illustrates the <em>local</em> (small-radius) analytic solution used by <code>SingleFieldInstanton.exactSolution</code> and how we choose
practical starting points via <code>SingleFieldInstanton.initialConditions</code>. We work with the same thin- and thick-wall toy potentials from previous lots.</p>
<p><strong>How to run just this case (Run both examples at once)</strong></p>
<div class="highlight"><pre><span></span><code>python<span class="w"> </span>-m<span class="w"> </span>tests.tunneling1D.single_field.Lot_SF3<span class="w">  </span><span class="c1"># it includes all tests (more than the ones here)</span>
</code></pre></div>
<hr />
<h3 id="test-1-local-quadratic-solution-near-the-true-minimum-stable-curvature">Test 1 — Local quadratic solution near the true minimum (stable curvature)<a class="headerlink" href="#test-1-local-quadratic-solution-near-the-true-minimum-stable-curvature" title="Permanent link">&para;</a></h3>
<p><strong>What it shows</strong></p>
<ul>
<li>Around the stable minimum, <span class="arithmatex">\((V''(\phi_0)&gt;0)\)</span>, the non-singular solution behaves smoothly with <span class="arithmatex">\((\phi'(0)=0)\)</span> and a quadratic rise at small (r).</li>
<li>The plot overlays <span class="arithmatex">\((\phi(r)-\phi_0)\)</span> and <span class="arithmatex">\((\phi'(r))\)</span> computed by <code>exactSolution</code>.</li>
</ul>
<p><strong>Expected result</strong></p>
<ul>
<li><span class="arithmatex">\((\phi'(0)=0)\)</span> numerically.</li>
<li><span class="arithmatex">\((\phi(r)-\phi_0)\)</span> grows <span class="arithmatex">\((\propto r^2)\)</span> for very small (r); <span class="arithmatex">\((\phi'(r)\propto r)\)</span>.</li>
</ul>
<p><strong>Console excerpts (typical)</strong></p>
<div class="highlight"><pre><span></span><code>=== Test 1: Local quadratic solution near abs minimum (d2V &gt; 0) ===
 Thin: dV(phi0)=5.315e-04, d2V(phi0)=5.331e-01, rscale≈1.668e+00
  Expectation: phi&#39;(0)=0, smooth quadratic rise; numerical curve should be regular.

 Thick: dV(phi0)=8.018e-04, d2V(phi0)=8.036e-01, rscale≈2.357e+00
  Expectation: phi&#39;(0)=0, smooth quadratic rise; numerical curve should be regular.
</code></pre></div>
<p><strong>Figure</strong></p>
<p><img alt="Test 1 — Near abs minimum (d2V&gt;0): thin wall; (\phi(r)-\phi_0) and (\phi'(r))" src="../assets/SF3_1.png" /></p>
<p><img alt="Test 1 — Near abs minimum (d2V&gt;0): thick wall; (\phi(r)-\phi_0) and (\phi'(r))" src="../assets/SF3_2.png" /></p>
<hr />
<h3 id="test-2-local-solution-near-the-barrier-top-unstable-curvature">Test 2 — Local solution near the barrier top (unstable curvature)<a class="headerlink" href="#test-2-local-solution-near-the-barrier-top-unstable-curvature" title="Permanent link">&para;</a></h3>
<p><strong>What it shows</strong></p>
<ul>
<li>At the barrier top <span class="arithmatex">\((\phi_{\text{top}})\)</span>, <span class="arithmatex">\((V'(\phi_{\text{top}})\approx 0)\)</span> and <span class="arithmatex">\((V''(\phi_{\text{top}})&lt;0)\)</span>.</li>
<li><code>exactSolution</code> switches to the <span class="arithmatex">\((J_\nu)\)</span> branch; the solution remains regular at (r=0) with <span class="arithmatex">\((\phi'(0)=0)\)</span>, </li>
<li>but the local shape reflects the inverted curvature.</li>
</ul>
<p><strong>Expected result</strong></p>
<ul>
<li>Printed curvature satisfies <span class="arithmatex">\((d^2V(\phi_{\text{top}})&lt;0)\)</span> (up to near-flat numerical cases).</li>
<li>Plots show a small-(r) “inverted” profile relative to <span class="arithmatex">\((\phi_{\text{top}})\)</span>, still smooth at the origin.</li>
</ul>
<p><strong>Console excerpts (typical)</strong></p>
<div class="highlight"><pre><span></span><code>=== Test 2: Local solution near barrier top (d2V &lt; 0) ===
 Thin: phi_top=0.470000, dV(phi_top)=-1.268e-10, d2V(phi_top)=-2.491e-01
  Expectation: d2V &lt; 0 → oscillatory (J_ν) behavior; still regular at r=0 with phi&#39;(0)=0.

 Thick: phi_top=0.200000, dV(phi_top)=-2.250e-11, d2V(phi_top)=-1.600e-01
  Expectation: d2V &lt; 0 → oscillatory (J_ν) behavior; still regular at r=0 with phi&#39;(0)=0.
</code></pre></div>
<p><strong>Figure</strong></p>
<p><img alt="Test 2 — Near barrier top thin (d2V&lt;0): (\phi(r)-\phi_{\text{top}}) and (\phi'(r))" src="../assets/SF3_3.png" /></p>
<p><img alt="Test 2 — Near barrier top thick (d2V&lt;0): (\phi(r)-\phi_{\text{top}}) and (\phi'(r))" src="../assets/SF3_4.png" /></p>
<hr />
<h3 id="test-4-initialconditions-pick-r_0phir_0phir_0-and-visualize-the-short-path">Test 4 — <code>initialConditions</code>: pick <span class="arithmatex">\(((r_0,\phi(r_0),\phi'(r_0)))\)</span> and visualize the short path<a class="headerlink" href="#test-4-initialconditions-pick-r_0phir_0phir_0-and-visualize-the-short-path" title="Permanent link">&para;</a></h3>
<p><strong>What it shows</strong></p>
<ul>
<li>Given an interior offset <span class="arithmatex">\((\Delta\phi_0)\)</span> and a target cutoff <span class="arithmatex">\((|\Delta\phi(r_0)|)\)</span>, we solve for a practical <span class="arithmatex">\((r_0)\)</span>.</li>
<li>The short trajectory from (r=0) to <span class="arithmatex">\((r=r_0)\)</span> is plotted using the same local quadratic solution; the chosen starting point is marked.</li>
</ul>
<p><strong>Expected result</strong></p>
<ul>
<li>$|\phi(r_0)-\phi_{\text{abs}}|\gtrsim $ cutoff.</li>
<li><span class="arithmatex">\(sign(\phi'(r_0))=\operatorname{sign}(\Delta\phi_0)\)</span>.</li>
</ul>
<p><strong>Console excerpts (typical)</strong></p>
<div class="highlight"><pre><span></span><code>=== Test 4: initialConditions (r0, phi(r0), phi&#39;(r0)) ===
 Thin: r0=1.667709e-03, phi(r0)=1.018316e+00, phi&#39;(r0)=5.685050e-06
  Expectation: |phi(r0)-phi_absMin| ≳ cutoff, and phi&#39;(r0) has the same sign as delta_phi0.

 Thick: r0=2.357023e-03, phi(r0)=1.018316e+00, phi&#39;(r0)=1.199135e-05
  Expectation: |phi(r0)-phi_absMin| ≳ cutoff, and phi&#39;(r0) has the same sign as delta_phi0.
</code></pre></div>
<p><strong>Figure</strong></p>
<p><img alt="Test 4 — initialConditions: short path to (r_0) and start marker thin" src="../assets/SF3_7.png" /></p>
<p><img alt="Test 4 — initialConditions: short path to (r_0) and start marker thick" src="../assets/SF3_8.png" /></p>
<hr />
<h3 id="test-5-initialconditions-error-path-unreachable-cutoff">Test 5 — <code>initialConditions</code> error path (unreachable cutoff)<a class="headerlink" href="#test-5-initialconditions-error-path-unreachable-cutoff" title="Permanent link">&para;</a></h3>
<p><strong>What it shows</strong></p>
<ul>
<li>If <span class="arithmatex">\((\Delta\phi_0=0)\)</span> exactly (starting right at the true minimum) and the cutoff is strictly positive, </li>
<li>the local model never reaches the cutoff; the function raises a clear <code>IntegrationError</code>.</li>
</ul>
<p><strong>Expected result</strong></p>
<ul>
<li>A caught <code>IntegrationError</code> with an informative message.</li>
</ul>
<p><strong>Console excerpts (typical)</strong></p>
<div class="highlight"><pre><span></span><code>=== Test 5: initialConditions error (unreachable cutoff) ===
 Thin: Caught expected IntegrationError:
   initialConditions: failed to bracket r0 (no crossing found).

 Thick: Caught expected IntegrationError:
   initialConditions: failed to bracket r0 (no crossing found).

---------- END OF TESTS: Lot SF-3 ----------
</code></pre></div>
<ul>
<li>For more context (potential, barrier, and scaling) see Lots <strong>SF1</strong> and <strong>SF2</strong> above.</li>
</ul>
<hr />
<h2 id="lot-sf-4-ode-core-eom-event-detection-sampler">Lot SF-4 — ODE core (EOM, event detection, sampler)<a class="headerlink" href="#lot-sf-4-ode-core-eom-event-detection-sampler" title="Permanent link">&para;</a></h2>
<p><strong>Goal.</strong> Exercise the heart of the solver:</p>
<ul>
<li>The <strong>equation of motion</strong> (EOM) used everywhere:</li>
</ul>
<div class="arithmatex">\[\frac{d^2\phi}{dr^2} + \frac{\alpha}{r}\frac{d\phi}{dr} = b\frac{dV}{d\phi}(\phi)\]</div>
<p>written as a first-order system in <span class="arithmatex">\((y=(\phi,\phi'))\)</span>.
* The <strong>adaptive RKQS driver</strong> that advances the solution and classifies steps as
  <strong>undershoot</strong> (turning point before reaching the false vacuum) or <strong>overshoot</strong>
  (crosses <span class="arithmatex">\((\phi_{\rm meta})\)</span> within the step).
* The <strong>sampler</strong> that records <span class="arithmatex">\(((\phi,\phi'))\)</span> on a user grid (R) using cubic
  Hermite interpolation between accepted RK steps.</p>
<p><strong>Physics intuition.</strong></p>
<ul>
<li>For the bounce, the field starts near the <strong>true</strong> minimum <span class="arithmatex">\((\phi_{\rm abs})\)</span> and tries to “climb” toward the <strong>false</strong> minimum <span class="arithmatex">\((\phi_{\rm meta})\)</span>.</li>
<li>If it <strong>turns around</strong> <span class="arithmatex">\(((\phi'\to 0))\)</span> before it ever reaches <span class="arithmatex">\((\phi_{\rm meta})\)</span>, we say <strong>undershoot</strong>.</li>
<li>If it <strong>crosses</strong> <span class="arithmatex">\((\phi_{\rm meta})\)</span> at finite radius, that’s an <strong>overshoot</strong>.</li>
<li>The friction term <span class="arithmatex">\((\alpha,\phi'/r)\)</span> is large at small (r), so the outcome depends delicately on the starting offset and slope.</li>
</ul>
<p><strong>Script:</strong> <code>tests/tunneling1D/single_field/Lot_SF4.py</code>
<strong>Run all examples in this lot:</strong></p>
<div class="highlight"><pre><span></span><code>python<span class="w"> </span>-m<span class="w"> </span>tests.tunneling1D.single_field.Lot_SF4
</code></pre></div>
<p>We keep the same toy potentials as before:</p>
<div class="arithmatex">\[\textbf{THIN}: \quad \tfrac14\phi^4 - 0.49\phi^3 + 0.235\phi^2\]</div>
<div class="arithmatex">\[\textbf{THICK}: \quad \tfrac14\phi^4 - \tfrac{2}{5}\phi^3 + \tfrac{1}{10}\phi^2\]</div>
<p><strong>Notes on tolerances.</strong> In the examples we build
<span class="arithmatex">\((\texttt{epsfrac}=[\texttt{phitol},\texttt{phitol}])\)</span> and
<span class="arithmatex">\((\texttt{epsabs}=[\texttt{phitol}\cdot|\Delta\phi|,\texttt{phitol}\cdot|\Delta\phi|/r_{\rm scale}])\)</span>.
If you see a “step size underflow” in thin-wall cases, relaxing to <code>phitol=1e-4</code> is often enough.</p>
<hr />
<h3 id="test-b-thin-wall-event-detection-two-undershoots">Test B — Thin-wall: event detection (two undershoots)<a class="headerlink" href="#test-b-thin-wall-event-detection-two-undershoots" title="Permanent link">&para;</a></h3>
<p><strong>What this shows</strong></p>
<ul>
<li>How <code>integrateProfile</code> detects <strong>turning points</strong> on a thin-wall potential.</li>
<li>Two runs with different “shooting” parameters (x) (mapped internally to the initial offset <span class="arithmatex">\((\Delta\phi_0 = e^{-x}(\phi_{\rm meta}-\phi_{\rm abs})))\)</span>.</li>
<li>For this potential and the chosen cutoff, both choices typically <strong>undershoot</strong> (large friction and small initial energy).</li>
</ul>
<p><strong>Expected outcome</strong></p>
<ul>
<li>Printed classification: <code>undershoot</code> in both panels, with an event radius <span class="arithmatex">\((r_{\rm evt})\)</span> where <span class="arithmatex">\((\phi'(r_{\rm evt})\approx 0)\)</span>.</li>
<li>Plots show <span class="arithmatex">\((\phi(r))\)</span> decreasing from near (\phi_{\rm abs}), then flattening at the turning point before reaching <span class="arithmatex">\((\phi_{\rm meta})\)</span> (dashed line).</li>
</ul>
<p><strong>How the figure is built</strong></p>
<ul>
<li>We integrate until the event is detected, then call <code>integrateAndSaveProfile</code> to <strong>sample</strong> <span class="arithmatex">\((\phi(r))\)</span> densely up to <span class="arithmatex">\((r_{\rm evt})\)</span>.</li>
<li>The event is marked with a vertical dotted line and a dot at <span class="arithmatex">\(((r_{\rm evt},\phi(r_{\rm evt})))\)</span>.</li>
</ul>
<p><strong>Console excerpt</strong></p>
<div class="highlight"><pre><span></span><code>=== Test B: Event detection on thin-wall potential ===
[thin-wall :: x=6.00] event = undershoot at r=1.566617e+01 (phi=2.441311e-01, dphi=6.852158e-17)
[thin-wall :: x=0.20] event = undershoot at r=1.046569e-02 (phi=1.812700e-01, dphi=1.498745e-04)
</code></pre></div>
<p><strong>Figure</strong>
<em>Thin-wall: two trajectories that undershoot (turning point before the false vacuum).</em></p>
<p><img alt="Test B —  Event detection on thin-wall potential" src="../assets/SF4_1.png" /></p>
<hr />
<h3 id="test-c-thick-wall-one-undershoot-one-overshoot">Test C — Thick-wall: one undershoot, one overshoot<a class="headerlink" href="#test-c-thick-wall-one-undershoot-one-overshoot" title="Permanent link">&para;</a></h3>
<p><strong>What this shows</strong></p>
<ul>
<li>
<p>On the thick-wall potential, different (x) give <strong>opposite outcomes</strong>:</p>
</li>
<li>
<p>A smaller initial offset (low energy) → <strong>undershoot</strong>;</p>
</li>
<li>A larger offset (high energy) → <strong>overshoot</strong> (crossing of <span class="arithmatex">\(\phi_{meta}\)</span> ).</li>
</ul>
<p><strong>Expected outcome</strong></p>
<ul>
<li>Left panel: <code>undershoot</code> with <span class="arithmatex">\((\phi'(r_{\rm evt})\approx 0)\)</span> at finite (r), and <span class="arithmatex">\((\phi(r))\)</span> still above <span class="arithmatex">\((\phi_{\rm meta})\)</span>.</li>
<li>Right panel: <code>overshoot</code> with a detected root of <span class="arithmatex">\((\phi(r)-\phi_{\rm meta}=0)\)</span>; the crossing point is annotated.</li>
</ul>
<p><strong>Console excerpt</strong></p>
<div class="highlight"><pre><span></span><code>=== Test C: Event detection on thick-wall potential ===
[thick-wall :: x=0.20] event = undershoot at r=4.714045e-03 (phi=1.812693e-01, dphi=4.642159e-06)
[thick-wall :: x=6.00] event =  overshoot at r=1.218941e+01 (phi=-4.989932e-15, dphi=-1.713411e-01)
</code></pre></div>
<p><strong>Figure</strong>
<em>Thick-wall: undershoot (left) and overshoot (right); both events detected and marked.</em>
<img alt="Test C —  Event detection on thick-wall potential" src="../assets/SF4_2.png" /></p>
<hr />
<h3 id="test-d-sampling-with-integrateandsaveprofile-on-a-user-grid">Test D — Sampling with <code>integrateAndSaveProfile</code> on a user grid<a class="headerlink" href="#test-d-sampling-with-integrateandsaveprofile-on-a-user-grid" title="Permanent link">&para;</a></h3>
<p><strong>What this shows</strong></p>
<ul>
<li>You provide a <strong>monotone grid</strong> <span class="arithmatex">\((R={r_i})\)</span> and a starting state <span class="arithmatex">\(((r_0,\phi(r_0),\phi'(r_0)))\)</span>.</li>
<li>The solver advances with adaptive RK and <strong>fills every requested point</strong> using <strong>cubic Hermite</strong> interpolation (the same shape preserved internally for events).</li>
</ul>
<p><strong>Expected outcome</strong></p>
<ul>
<li>A smooth curve <span class="arithmatex">\((\phi(r))\)</span> across the whole user grid.</li>
<li><code>Rerr</code> is <code>None</code> in typical runs; if the step would fall below <code>drmin</code>, the step is clamped and <code>Rerr</code> reports the <strong>first</strong> radius where this happened.</li>
</ul>
<p><strong>Console excerpt (paste your run)</strong></p>
<div class="highlight"><pre><span></span><code>=== Test D: integrateAndSaveProfile on a user R-grid ===
Profile sampled at 300 points.
Rerr (first clamped step radius) = None
</code></pre></div>
<p><strong>Figure</strong>
<em>“Sampling <span class="arithmatex">\(\phi(r)\)</span> on a fixed grid provided by the user.</em>
<img alt="Test D —  Event detection on thick-wall potential" src="../assets/SF4_3.png" /></p>
<hr />
<h3 id="test-f-explicit-initial-conditions-thin-wall">Test F — Explicit initial conditions (thin-wall)<a class="headerlink" href="#test-f-explicit-initial-conditions-thin-wall" title="Permanent link">&para;</a></h3>
<p><strong>What this shows</strong></p>
<ul>
<li>Instead of deriving <span class="arithmatex">\(((r_0,\phi(r_0),\phi'(r_0)))\)</span> from a shooting parameter (x), we <strong>set them explicitly</strong> to demonstrate that the event classification logic does not depend on how the initial state was chosen.</li>
<li>
<p>Two examples:</p>
</li>
<li>
<p>A gentle start near the true minimum with a small negative slope → often <strong>undershoot</strong>.</p>
</li>
<li>A more aggressive start with sizable downhill slope → tends to <strong>overshoot</strong> (depending on details of the potential and tolerances).</li>
</ul>
<p><strong>Expected outcome</strong></p>
<ul>
<li>Clear printed event classification with the detected <span class="arithmatex">\((r_{\rm evt})\)</span>.</li>
<li>Plots up to the event look consistent with the classification (turning point vs. crossing).</li>
</ul>
<p><strong>Console excerpt (paste your run)</strong></p>
<div class="highlight"><pre><span></span><code>=== Test F: Explict Initial Conditions on thin-wall potential ===
[thin-wall :: x=[0.001, [0.9, -0.1]]] event = undershoot at r=1.045860e+01 (phi=3.544355e-01, dphi=0.000000e+00)
[thin-wall :: x=[1, [0.3, -2]]] event =  overshoot at r=1.176781e+00 (phi=-1.040834e-17, dphi=-1.439106e+00)
---------- END: Lot SF-4 examples ----------
</code></pre></div>
<p><strong>Figure</strong>
<em>Thin-wall with explicit initial states: undershoot (left) and overshoot (right).</em>
<img alt="Test F —  Event detection on thick-wall potential" src="../assets/SF4_4.png" /></p>
<hr />
<p><strong>See more:</strong> full executable script at
<a href="/tests/tunneling1D/single_field/Lot_SF4.py"><code>tests/single_field/Lot_SF4.py</code></a>.</p>
<hr />
<h2 id="lot-sf-5-profile-search-findprofile">Lot SF-5 — Profile search (<code>findProfile</code>)<a class="headerlink" href="#lot-sf-5-profile-search-findprofile" title="Permanent link">&para;</a></h2>
<p><strong>Goal.</strong> Demonstrate the full <strong>overshoot/undershoot</strong> shooting procedure that determines the instanton profile <span class="arithmatex">\(( \phi(r) )\)</span>,
and show how two knobs—<code>thinCutoff</code> and the optional “interior fill”—affect only the very small-( r ) part of the curve in thin-wall situations.</p>
<p><em>Solver recap (physics):</em> We want the regular (non-singular) solution that starts near the true minimum <span class="arithmatex">\(( \phi_{\rm abs} )\)</span> at ( r=0 ) and asymptotes to the false minimum <span class="arithmatex">\(( \phi_{\rm meta} )\)</span> as <span class="arithmatex">\(( r\to\infty )\)</span>. 
<code>findProfile</code> varies the “shooting” parameter ( x ) (equivalently <span class="arithmatex">\(( \Delta\phi_0 \propto e^{-x} )\)</span> ) 
and repeatedly integrates the ODE.</p>
<ul>
<li>If the trajectory <strong>crosses</strong> <span class="arithmatex">\(( \phi_{\rm meta} )\)</span> within a step ⇒ <strong>overshoot</strong> (initial kick too large).</li>
<li>If it <strong>turns around</strong> (hits <span class="arithmatex">\(( \phi'(r)=0 )\)</span> ) before reaching <span class="arithmatex">\(( \phi_{\rm meta} )\)</span> ⇒ <strong>undershoot</strong> (kick too small).
  Bisection on ( x ) lands on the unique critical trajectory; then the profile is sampled densely.</li>
</ul>
<p>See the full, executable script here: <a href="/tests/tunneling1D/single_field/Lot_SF5.py"><code>tests/tunneling1D/single_field/Lot_SF5.py</code></a>.</p>
<p>For all examples we reuse the same toy potentials:</p>
<div class="arithmatex">\[\textbf{THIN:}\quad \tfrac{1}{4}\phi^4 - 0.49,\phi^3 + 0.235,\phi^2\]</div>
<div class="arithmatex">\[\textbf{THICK:}\quad \tfrac{1}{4}\phi^4 - \tfrac{2}{5}\phi^3 + \tfrac{1}{10}\phi^2\]</div>
<p>with <span class="arithmatex">\(( \phi_{\rm abs}=1 )\)</span> and <span class="arithmatex">\(( \phi_{\rm meta}=0 )\)</span>, and <span class="arithmatex">\(( \alpha=2 )\)</span> (O(3) bounce).</p>
<p><strong>Script:</strong> <code>tests/tunneling1D/single_field/Lot_SF5.py</code>
<strong>How to run just this lot</strong></p>
<div class="highlight"><pre><span></span><code>python<span class="w"> </span>-m<span class="w"> </span>tests.tunneling1D.single_field.Lot_SF5
</code></pre></div>
<hr />
<h3 id="test-1-legacy-demo-thin-thick-walls-default-settings">Test 1 — Legacy demo: thin &amp; thick walls (default settings)<a class="headerlink" href="#test-1-legacy-demo-thin-thick-walls-default-settings" title="Permanent link">&para;</a></h3>
<p><strong>What this shows</strong></p>
<ul>
<li>A faithful reproduction of the legacy quick-start: one call per potential,</li>
</ul>
<div class="highlight"><pre><span></span><code>  profile = SingleFieldInstanton(1.0, 0.0, V, dV).findProfile()
</code></pre></div>
<p>and a plot of <span class="arithmatex">\(( \phi(r) )\)</span>.
* Horizontal guides at <span class="arithmatex">\(( \phi_{\rm abs} )\)</span> and <span class="arithmatex">\(( \phi_{\rm meta} )\)</span> for context.
* Console diagnostics: start/end radii, terminal residual <span class="arithmatex">\(( |\phi(r_f)-\phi_{\rm meta}| )\)</span>.</p>
<p><strong>Physical expectations</strong></p>
<ul>
<li><strong>Thin-wall</strong>: The field sits near <span class="arithmatex">\(( \phi_{\rm abs} )\)</span> until a relatively sharp transition (“thin” wall) then approaches <span class="arithmatex">\(( \phi_{\rm meta} )\)</span>.</li>
<li><strong>Thick-wall</strong>: Transition is more gradual; the wall is “thicker.”</li>
<li>Both runs should converge without manual tuning (defaults are chosen to be robust).</li>
</ul>
<p><strong>Paste your console excerpt here</strong></p>
<div class="highlight"><pre><span></span><code>=== Test 1: Legacy demo — thin &amp; thick walls ===
=== Test 1: Legacy demo — thin &amp; thick walls ===
[thin-wall] profile: R[0]=0.000000e+00, R[-1]=6.193054e+01
         φ(r0)=1.000000e+00, φ(rf)=-1.857581e-04, |φ(rf)-φ_meta|=1.858e-04, φ&#39;(rf)=-1.679e-04
         Rerr=None

[thick-wall] profile: R[0]=0.000000e+00, R[-1]=2.089406e+01
         φ(r0)=7.420233e-01, φ(rf)=9.449128e-06, |φ(rf)-φ_meta|=9.449e-06, φ&#39;(rf)=-1.251e-04
         Rerr=None
</code></pre></div>
<p><strong>Figure</strong>
<em>“findProfile — legacy thin/thick demos; horizontal guides at <span class="arithmatex">\(\phi_{abs}\)</span> and <span class="arithmatex">\(\phi_{meta}\)</span>.”</em>
<img alt="Test 1 — legacy thin/thick demos" src="../assets/SF5_1.png" /></p>
<hr />
<h3 id="test-2-sensitivity-to-thincutoff-and-interior-fill-thin-wall">Test 2 — Sensitivity to <code>thinCutoff</code> and interior fill (thin wall)<a class="headerlink" href="#test-2-sensitivity-to-thincutoff-and-interior-fill-thin-wall" title="Permanent link">&para;</a></h3>
<p><strong>What this shows</strong></p>
<ul>
<li>
<p>Two thin-wall profiles with identical physics but different handling of the <strong>tiny-radius</strong> region:</p>
</li>
<li>
<p><strong>Case A:</strong> <code>thinCutoff=0.01</code>, <code>max_interior_pts=None</code> (default). The solver places synthetic points inside the bubble using the local quadratic solution to illustrate the smooth <span class="arithmatex">\(( r\to0 )\)</span> behavior.</p>
</li>
<li><strong>Case B:</strong> <code>thinCutoff=0.15</code>, <code>max_interior_pts=0</code>. We start farther from the origin (bigger cutoff) and <strong>disable</strong> interior fill, so the curve begins at <span class="arithmatex">\(( r=r_0&gt;0 )\)</span>.</li>
</ul>
<p><strong>Physical expectations</strong></p>
<ul>
<li>The two curves should <strong>match</strong> once ( r ) is beyond the artificially chosen <span class="arithmatex">\(( r_0 )\)</span>. Only the very small-( r ) portion differs—this is numerical bookkeeping, not different physics.</li>
<li>The terminal residual and action should be essentially unchanged; only <span class="arithmatex">\(( r_0 )\)</span> and the early segment of <span class="arithmatex">\(( \phi(r) )\)</span> shift.</li>
</ul>
<p><strong>Paste your console excerpt here</strong></p>
<div class="highlight"><pre><span></span><code>=== Test 2: Sensitivity to thinCutoff and interior fill (thin wall) ===
[thin (A: thinCutoff=0.01, interior ON)] profile: R[0]=0.000000e+00, R[-1]=6.323233e+01
         φ(r0)=1.000000e+00, φ(rf)=-2.498747e-20, |φ(rf)-φ_meta|=2.499e-20, φ&#39;(rf)=-1.572e-05
         Rerr=None

[thin (B: thinCutoff=0.15, interior OFF)] profile: R[0]=3.469565e+01, R[-1]=5.052437e+01
         φ(r0)=8.500000e-01, φ(rf)=1.395670e-04, |φ(rf)-φ_meta|=1.396e-04, φ&#39;(rf)=4.599e-18
         Rerr=None
</code></pre></div>
<p><strong>Figure</strong>
<em>Effect of <code>thinCutoff</code> &amp; interior fill in a thin-wall case — curves overlay for <span class="arithmatex">\(r \gtrsim r_0\)</span>.</em>
<img alt="Test 2 — Effect of thinCutoff &amp; interior fill in a thin-wall" src="../assets/SF5_2.png" /></p>
<hr />
<h2 id="lot-sf-6-action-post-processing">Lot SF-6 — Action &amp; post-processing<a class="headerlink" href="#lot-sf-6-action-post-processing" title="Permanent link">&para;</a></h2>
<p><strong>Goal.</strong> Take a computed bounce profile and extract physically meaningful, easy-to-compare summaries:</p>
<ul>
<li>Total Euclidean action via <code>findAction</code>.</li>
<li>A full <strong>action breakdown</strong> (kinetic, potential, interior bulk) and <strong>per-r densities</strong> via <code>actionBreakdown</code>.</li>
<li>A <strong>uniform φ-grid</strong> view of the wall via <code>evenlySpacedPhi</code>.</li>
<li><strong>Wall geometry</strong> (location and thickness) via <code>wallDiagnostics</code>.</li>
<li>Order-of-magnitude <strong>β-proxies</strong> via <code>betaEff</code> (<code>rscale</code>, <code>curvature</code>, <code>wall</code>).</li>
</ul>
<p>We continue to use the same benchmark potentials as in earlier lots:</p>
<div class="arithmatex">\[\textbf{THIN:}\quad V(\phi)=\tfrac14\phi^4 - 0.49\phi^3 + 0.235\phi^2 \]</div>
<div class="arithmatex">\[ \textbf{THICK:}\quad V(\phi)=\tfrac14\phi^4 - 0.40\phi^3 + 0.10\phi^2 \]</div>
<p>with <span class="arithmatex">\((\phi_{\rm abs}=1)\)</span> (true vacuum) and <span class="arithmatex">\((\phi_{\rm meta}=0)\)</span> (false vacuum).</p>
<p><strong>Script:</strong> <code>tests/tunneling1D/single_field/Lot_SF6.py</code>
<strong>Run all examples:</strong></p>
<div class="highlight"><pre><span></span><code>python<span class="w"> </span>-m<span class="w"> </span>tests.tunneling1D.single_field.Lot_SF6
</code></pre></div>
<hr />
<h3 id="test-a-action-density-breakdown">Test A — Action &amp; density breakdown<a class="headerlink" href="#test-a-action-density-breakdown" title="Permanent link">&para;</a></h3>
<p><strong>What this shows</strong></p>
<ul>
<li>
<p>For each potential, we compute the profile, then:</p>
</li>
<li>
<p><code>findAction(profile)</code> → total Euclidean action (S).</p>
</li>
<li><code>actionBreakdown(profile)</code> → numerical values of (S_{\rm kin}), (S_{\rm pot}), interior bulk, and arrays of per-r <strong>densities</strong>:</li>
</ul>
<div class="arithmatex">\[\text{kin density}=\tfrac12(\phi')^2r^{\alpha}\Omega_\alpha \]</div>
<div class="arithmatex">\[\text{pot density}=\big[V(\phi)-V(\phi_{\rm meta})\big]r^{\alpha}\Omega_\alpha\]</div>
<ul>
<li>Plots of the densities vs (r) highlight <strong>where</strong> the action accumulates (typically in the wall).</li>
</ul>
<p><strong>Expected outcome (physics)</strong></p>
<ul>
<li>The <strong>thin-wall</strong> case shows a <strong>narrow, high</strong> density peak (sharper wall).</li>
<li>The <strong>thick-wall</strong> case shows a <strong>broader</strong> distribution (wall spread out).</li>
<li>Console check: <span class="arithmatex">\((S_{\rm total}\approx S_{\rm kin}+S_{\rm pot}+S_{\rm interior})\)</span> (within numerical accuracy).</li>
</ul>
<p><strong>Example console excerpt</strong></p>
<div class="highlight"><pre><span></span><code>=== Test A: Actions and density breakdown ===
[thin-wall]
  S_total    = 1.093093e+03
   S_kin     = 1.639021e+03
   S_pot     = -5.459281e+02
   S_interior= 0.000000e+00
  (check) S_kin + S_pot + S_interior = 1.093093e+03
[thick-wall]
  S_total    = 6.630329e+00
   S_kin     = 9.946114e+00
   S_pot     = -3.315785e+00
   S_interior= 0.000000e+00
  (check) S_kin + S_pot + S_interior = 6.630329e+00
</code></pre></div>
<p><strong>Figure</strong>
<em>“Action densities vs (r): thin (left) and thick (right). The peak localizes around the wall.”</em>
<img alt="Test A — Action densities vs (r)" src="../assets/SF6_1.png" /></p>
<hr />
<h3 id="test-b-uniform-grid-resampling-evenlyspacedphi">Test B — Uniform φ-grid resampling (<code>evenlySpacedPhi</code>)<a class="headerlink" href="#test-b-uniform-grid-resampling-evenlyspacedphi" title="Permanent link">&para;</a></h3>
<p><strong>What this shows</strong></p>
<ul>
<li>
<p>We resample <span class="arithmatex">\(((\phi,\phi'))\)</span> on an <strong>evenly spaced grid in <span class="arithmatex">\((\phi)\)</span></strong> rather than (r):</p>
</li>
<li>
<p>This gives a clean, potential-centric view of the wall: <span class="arithmatex">\((d\phi/dr)\)</span> vs <span class="arithmatex">\((\phi)\)</span>.</p>
</li>
<li>Helpful to compare how quickly the field <em>sweeps</em> through field space.</li>
</ul>
<p><strong>Expected outcome (physics)</strong></p>
<ul>
<li>Thin-wall: a <strong>sharper feature</strong> in <span class="arithmatex">\((d\phi/dr)\)</span> near mid-<span class="arithmatex">\((\phi)\)</span> (rapid transition).</li>
<li>Thick-wall: a <strong>smoother, broader</strong> shape in <span class="arithmatex">\((d\phi/dr)\)</span> across <span class="arithmatex">\((\phi)\)</span>.</li>
</ul>
<p><strong>Figure</strong>
<em>“Resampled <span class="arithmatex">\((d\phi/dr)\)</span> vs <span class="arithmatex">\((\phi)\)</span>: thin and thick. Both curves start/end with zero slope at the vacua.”</em>
<img alt="Test B1 — Resampled \((d\phi/dr)\) vs \((\phi)\)" src="../assets/SF6_2.png" /></p>
<p><img alt="Test B2 — Resampled \((d\phi/dr)\) vs \((\phi)\)" src="../assets/SF6_3.png" /></p>
<hr />
<h3 id="test-c-wall-diagnostics-location-thickness">Test C — Wall diagnostics (location &amp; thickness)<a class="headerlink" href="#test-c-wall-diagnostics-location-thickness" title="Permanent link">&para;</a></h3>
<p><strong>What this shows</strong></p>
<ul>
<li>
<p><code>wallDiagnostics(profile, frac=(0.1,0.9))</code> reports:</p>
</li>
<li>
<p><code>r_peak</code>: where <span class="arithmatex">\((|\phi'|)\)</span> is maximal (wall center),</p>
</li>
<li><code>r_lo</code>/<code>r_hi</code>: radii where <span class="arithmatex">\((\phi)\)</span> reaches 10% and 90% of the total excursion,</li>
<li><code>thickness</code> = <span class="arithmatex">\((|r_{\rm hi}-r_{\rm lo}|)\)</span></li>
<li><code>r_mid</code>: where <span class="arithmatex">\((\phi)\)</span> is halfway between the vacua.</li>
</ul>
<p><strong>Expected outcome (physics)</strong></p>
<ul>
<li>Thin-wall → <strong>smaller</strong> thickness; <code>r_peak</code> between <code>r_lo</code> and <code>r_hi</code>.</li>
<li>Thick-wall → <strong>larger</strong> thickness; markers spaced farther apart.</li>
</ul>
<p><strong>Example console excerpt</strong></p>
<div class="highlight"><pre><span></span><code>=== Test C: Wall diagnostics (location &amp; thickness) ===
[thin-wall] r_peak=4.706284e+01, r_mid=4.707676e+01, r_lo=4.396172e+01, r_hi=5.019140e+01, thickness=6.229675e+00 (phi_lo=0.900, phi_hi=0.100)
[thick-wall] r_peak=4.399554e+00, r_mid=3.787229e+00, r_lo=0.000000e+00, r_hi=7.990970e+00, thickness=7.990970e+00 (phi_lo=0.900, phi_hi=0.100)
</code></pre></div>
<p><strong>Figure</strong>
<em>“(\phi(r)) with vertical markers at <code>r_lo</code>, <code>r_mid</code>, <code>r_hi</code>, and <code>r_peak</code>.”</em>
<img alt="Test C1 — (\phi(r)) with vertical markers" src="../assets/SF6_4.png" /></p>
<p><img alt="Test C2 — (\phi(r)) with vertical markers" src="../assets/SF6_5.png" /></p>
<hr />
<h3 id="test-d-beta_rm-eff-proxies-rscale-vs-curvature-vs-wall">Test D — <span class="arithmatex">\((\beta_{\rm eff})\)</span> proxies: <code>rscale</code> vs <code>curvature</code> vs <code>wall</code><a class="headerlink" href="#test-d-beta_rm-eff-proxies-rscale-vs-curvature-vs-wall" title="Permanent link">&para;</a></h3>
<p><strong>What this shows</strong></p>
<p>We compare three quick <em>inverse-length</em> scales (proxies for a nucleation timescale):</p>
<ol>
<li><strong><code>rscale</code></strong>: <span class="arithmatex">\((\beta_{\rm eff}=1/r_{\rm scale})\)</span> (always defined, robust).</li>
<li><strong><code>curvature</code></strong>: <span class="arithmatex">\((\beta_{\rm eff}=\sqrt{|V''(\phi_{\rm top})|})\)</span> (requires a well-defined barrier top).</li>
<li><strong><code>wall</code></strong>: <span class="arithmatex">\((\beta_{\rm eff}=1/\text{thickness})\)</span> (from <code>wallDiagnostics</code>).</li>
</ol>
<p><strong>Expected outcome (physics)</strong></p>
<ul>
<li>Thin-wall: <strong>larger</strong> <span class="arithmatex">\((\beta_{\rm eff}(\text{wall}))\)</span> (thinner wall → shorter scale).</li>
<li><code>rscale</code> and <code>curvature</code> are often comparable within <span class="arithmatex">\((\mathcal{O}(1))\)</span> factors.</li>
<li>Thick-wall: all three proxies tend to be <strong>smaller</strong>.</li>
</ul>
<p><strong>Example console excerpt</strong></p>
<div class="highlight"><pre><span></span><code>=== Test D: β_eff proxies (rscale, curvature, wall) ===
[thin-wall] β_rscale=5.996249e-01, β_curv=4.990992e-01, β_wall=1.605220e-01
[thick-wall] β_rscale=4.242641e-01, β_curv=4.000000e-01, β_wall=1.251412e-01
---------- END: Lot SF-6 examples ----------
</code></pre></div>
<p><strong>Figure</strong>
<em>“Grouped bars of <span class="arithmatex">\((\beta_{\rm eff})\)</span> for thin vs thick, comparing the three proxies.”</em>
<img alt="Test D — Grouped bars of \beta_{\rm eff}" src="../assets/SF6_6.png" /></p>
<hr />
<p><strong>See the full, executable script for this lot here:</strong>
<a href="/tests/tunneling1D/single_field/Lot_SF6.py"><code>tests/single_field/Lot_SF6.py</code></a></p>
<p><em>Tip:</em> When comparing different models or temperatures, keep the <strong>same plotting and diagnostics</strong> so differences in actions, wall thickness, and <span class="arithmatex">\((\beta_{\rm eff})\)</span> are immediately visible and quantitatively comparable.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../../javascripts/mathjax-config.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>